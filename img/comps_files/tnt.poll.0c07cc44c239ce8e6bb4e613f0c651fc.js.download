!function(t,e){t.poll_config.forEach(function(t){function l(l,o){var i=e.getElementById("poll-"+t.id);("false"==i.getAttribute("data-charted")||1==o)&&fetch(t.results).then(function(l){return 200!==l.status?void console.log("Poll "+t.asset_id+" Status Code: "+l.status):void l.json().then(function(l){var r;r="pie"==t.chart?n(l.results):a(l.results),e.getElementById("poll-"+t.id+"-results").innerHTML=r,i.setAttribute("data-charted","true")})})["catch"](function(e){console.log("Fetch Error "+t.asset_id+": ",e)}),r(l)}function r(l){e.getElementById("poll-"+t.id+"-container").classList.add("hide"),e.getElementById("poll-"+t.id+"-results").classList.remove("hide"),l&&e.getElementById("poll-"+t.id+"-back-vote").classList.remove("hide")}function o(t){var e=0;for(var l in t)if(t.hasOwnProperty(l)){var r=t[l],o=r.votes;0===o&&r.text===i&&(o=1),e+=o}return e}function n(e){var l=o(e),r=0,n="100,0",a='<div class="tnt-chart-ledger">',s='<div class="tnt-chart"><svg class="tnt-chart-pie" viewBox="-100 -100 200 200" aria-labelledby="'+t.title+'"><g transform="rotate(-90)">';for(var d in e)if(e.hasOwnProperty(d)){var c=e[d],v=c.votes;0===v&&c.text===i&&(v=1);var u=(v/l*100).toFixed(1);if(0!=v){r>=l&&(n="100,0"),r+=v;var p=2*Math.PI*r/l,g=100*Math.cos(p),f=100*Math.sin(p),h=2>=l/v?1:0,m=1!=v?"votes":"vote";s+='<path d="M0,0 L'+n+" A100,100 0 "+h+",1 "+g+","+f+' Z" fill="'+c.color+'"><title>'+v+" "+m+"</title></path>",a+='<div class="tnt-ledger-item" title="'+v+" "+m+'"><span style="color:'+c.color+'"><span class="fas tnt-circle"></span></span> <strong>'+u+"%</strong> "+c.text+"</div>",n=g+","+f}}return 0>=r?'<div class="alert alert-warning">No votes have been submitted.</div>':s=s+"</g></svg>"+a+"</div></div>"}function a(e){var l=o(e),r=0,n=0,a=19,s="";for(var d in e)if(e.hasOwnProperty(d)){var c=e[d],v=c.votes;if(0===v&&c.text===i&&(v=1),0!=v){var u=v/l*100,p=u/2;s+='<g class="bar"><rect width="'+p+'%" height="'+a+'" y="'+n+'" style="fill: '+c.color+'"></rect><text x="'+(p+1)+'%" y="'+(a/2+n)+'" dy=".35em">'+v+" "+c.text+"</text></g>",r+=v,n+=a+1}}return 0>=r?'<div class="alert alert-warning">No votes have been submitted.</div>':s='<svg class="tnt-chart-bar" style="height:'+n+'px" aria-labelledby="'+t.title+'" role="img">'+s+"</svg>"}var i=localStorage.getItem("poll_"+t.asset_id);i&&(e.getElementById("poll-"+t.id+"-your-vote").innerHTML=i,e.getElementById("poll-"+t.id+"-your-vote-container").classList.remove("hide"),l()),e.getElementById("poll-"+t.id+"-form").addEventListener("submit",function(r){r.preventDefault();var o=e.querySelector("#poll-"+t.id+"-form input[name=answer]:checked").value;if(!o)return!1;var n=e.querySelector("#poll-"+t.id+"-form input[name=answer]:checked").getAttribute("title");if("function"==typeof dmpAction){var a="Poll : "+t.title+" : "+n;dmpAction(a)}var s=new XMLHttpRequest;s.open("POST",t.url+"?format=json&action=poll:vote"),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){4===s.readyState&&(200===s.status?(localStorage.setItem("poll_"+t.asset_id,n),i=n,l(!1,!0),e.getElementById("poll-"+t.id+"-your-vote").innerHTML=i,e.getElementById("poll-"+t.id+"-your-vote-container").classList.remove("hide")):console.log("A poll error occurred: "+s.status))},s.send(encodeURI("answer="+o))}),e.getElementById("poll-"+t.id+"-get-results").addEventListener("click",function(t){return t.preventDefault(),l(!0),!1}),e.getElementById("poll-"+t.id+"-back-btn").addEventListener("click",function(l){l.preventDefault(),e.getElementById("poll-"+t.id+"-back-vote").classList.add("hide"),e.getElementById("poll-"+t.id+"-results").classList.add("hide"),e.getElementById("poll-"+t.id+"-container").classList.remove("hide")})})}(window,document);
//# sourceMappingURL=tnt.poll.0c07cc44c239ce8e6bb4e613f0c651fc.js.map